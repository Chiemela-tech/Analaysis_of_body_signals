# -*- coding: utf-8 -*-
"""Group 13 - SVM Modelling of Smoking with body signal.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1PKF3-9ZZRuyhfNz9_neCyvJC_-s-G3EW

![](data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoHCBUWFRgVFhUZGBgYHBgYGBoZGBoYHBkYGhgaGhgYGhgcIS4lHB4rIRgYJjgmKy8xNTU1GiQ7QDszPy40NTEBDAwMEA8QHxISHjYrISs0NDQ0NDQxNDQ0NDQ0NDQ0NDQ0NDQxNDQ0NDQ0NDQ0NDQ0NDQxNDQ0NDQ0NDQ0ND80NP/AABEIAMIBAwMBIgACEQEDEQH/xAAbAAACAgMBAAAAAAAAAAAAAAAEBQMGAAECB//EAEEQAAIBAgQDBQUECAUEAwAAAAECAAMRBBIhMQVBUQYiYXGREzKBobFCUsHwFCNicsLR4fEHFSQzghaSssM0U2T/xAAaAQACAwEBAAAAAAAAAAAAAAAAAgEDBAUG/8QAJxEAAgIBBAICAgIDAAAAAAAAAAECEQMEEiExQVETYSIyNHEFQoH/2gAMAwEAAhEDEQA/ANUm5R3w2jmleoPrLNwusJmh2MywYWhYQl0kdCsLTVauBzl/BUC4mkDFmIwoMYVK8gd5DolCn9FAneS0mqGRsbSuiThjaDVGkrvInW8AIg0zNOGE1FJJGYSJEnQkokgbBsN5x7a0yodIDXeQ2BYsBxHSxMcU62YSgYeqQ0tHD8VoLx4yIaHQnFS0GfFAc4mx/FbaAxnJIhIPxeIC6yt47HFjlE6x71nAspAPhAaeHZXUWuxIsJVKVjpDXCYLcFbsBcA/jIaSuz5XbIByGgEsvDMOUzB1GYqCee8B43hUUB1OhuD+9K2xqFHFKy/7Qsw0Ob+shwuANtBvFruQ2ss+DxyUqQzasRfyg3QJAVZxQAJ3a14JxPjZci3uqBYCRYtHxLl1ByjQnYCCcUroiZEAB+0eZldWx1wLsZxR2O9h0kXtM6+PMRZUfXSbSrY3BtL9tLgiyWpTJG0AqvaF4jGEra8XO0aP2KyPNNTmZGIPR6BjfCVrRbTpwmkplaBlmw2K0m62Iiui9hOnqx9wtBgrTGriK2qmYrkyLAYCoILiK4nOUyGrTMLAxamskzQYCYz2gBI5nKrI1e8PoU5CAHKyMsYz9kJgoLJoBUwkDU4zxCgRc9SQyURGnzk9HFFZA7warVtIskYYniJI3iynXBdS21xeDvUkDmFhRdeKcWQIAnTSV7h+PYYhKrDMEN7deUWvWZrCE4ZNdZDZKVFzxHab2xVUTJrbX6xbjcWqkoO8dyTtcwfDoQcxsLRXxHEi+Yc/wkdgOKfAHcB7gDxMb/5NRVQ1VrgcusotDiNVmUZjYkALcy44jglV3poKlxbMw5LIrnonoD4txK6FaahKY0sNCZQcbWzseksfaystMmghzFfePjKmTpJin2yWQubQV6hk9doM0tQjOWec3mGaEYDi0ySWmQA9RojaFIsCovDKbSkGTiaM7VZ1ljkECpcw1KQAkS6SKpXtzkkBucCRVnEXmuYdgeFVqyl1sFHW9zrbTS1/MiQ2FWDO4gdZ4+/6TrkXDL/yIX5rmkR7HVz7z0l/5sf4IrYyiIUfW8MTFgRm3Yt+VdPirfUfym07E1TvVS3UZvoR+MhMHEWDiHjMbiUdr2C64g38EuPrOa3YMgdzEXPRkt/FG5CkVjEY28FNWO+I9ksRTGZSH8ACG9BcH15SuPcEgixBII6EbiKFE7VJC7TgtOTAk6CzTJOfaTauCRACfAUbtteWLAcLYAuy3NrhRyhdDh1OlkZgTmUEH6xzjans0JVgBbnJUbBspuNxpCkWsdbwTCcNJpmtWOVNcindjN4mqz1WKC99PjzMB43imHcY3tp5RV2A67IYWi1RndgMg7lyLX6xlxjtWlEMlIhqjaZhsJ5ytZ7EA2Ec8Owow9A42sM1zlooftP94+A/COk0DOzwOo49q5VA+vfNiSeg3gOM4Nl91g356yKlxj2z/rSbsd76A9AOQl8TBUKeGbE3zJTTW+5blp1vIp2FnlOLpkGx0IgpELxdcu7OdMxJt0vILRwIHE4BkryCMiDq83I7zIAeoUjDqAiyi8Z4YypAw5Fmys3SYTsgRhSCowi+rD6yxfVkMlEDvbbeeo4GsrpmsCRpyv56Ty2oJ6J2ecmmCTe+UjW5tkUa6b3Bv5RbpjLobu+m3oTIKh+vPp0H85M5gtd9ISkNFHLV1HKb/TB0+cVVq3ey85Ga8zPNRcsdjwYu/L5zr2uv9TFNDEAj4wqhVvLI5bEcKGlF+c8TxGrMerMfmZ7UrdwnoCflPFmF5e3wVVyQzlmm3kV4oETmRhyDeFezvNHDQAcYXtTURAhAYLtfW0l/TxiAS7het+nhEC4ckgAawgUsg1g+gHy46lRQ5BmY3AY/WUzG1Wdi7bkxzxNu4pXa3z5xHidBGSoCTAVUDLnF1J18pZv8VaLr+jZF/wBMEshG2c7g+OUC3xlWw2HLoWH2DY+R2lgxeNZ8A+HqG+UK9MndSpGl/K4jKuiGUYGMKnGK7UvYFzkuDl622v1i+YIAiS05aZecloAyKpIrSdxIwJIHOSbnV5kmwPQaMZUHiqi8JStKSWNRVnX6TFq15p6smyKGbVgYPU1gi1Z17WFhRqost3AsTUWgjDKQNLEWNhfY/CVO95auzxvhyOjH6k/xTnf5HNLFBSi65L8CTdMJftMg0dXU89AfoYFiO1FEjdumqn822gfFMPqYgxNCZMWulNfkdJaWHaHVXtPS+8d/unX5RfW7SIToT6GJalGCVKMvTjLtk/AkWvDdpaQX3jz+yT5aQhO2NNNkdvIAa/EylU6djbrJVp/jGT2vgSWOJ6Onan2lGoVplQEY3J11uOQ8/SUEPHiIVwtQjayodBzJI+Z3laYzZhk5RtmDNGMZUiZjBy00zyF2lxQELVky1RFuadhoEjLD11DgnaEVWQkhQS246WlerVTN8NxDGooubbRkhWOcNSvfMdDy6RJjx3yvTST+0bMRc7mTYbCF6lwOfz5mSCDezFNkZjYZWU5wdrbiD9p8UBZF2YcuQvJeK8RWivs01bn4nqfCVg1GYlmNydTBIOyFknBEMdBa8HcSSSEmbSmzHQTuil2UHmRPWuyfZ2jkDkAnxhJ0gSs8uThdRuR9JOvAX8f+2e60uGUh9gek4qYenyRfSVudEqJ4h/04/wC16TJ7RkT7q+gmRflfofYeXo8kWpAFeSq8YQOSpJA8DVpMsCAlHneaQLO4ASK8t3Y5rpUXob+oH8jKaBLT2Iqd90+8oPpcfxTB/kYbsDLIOmH4+lvEOJo+EtWMTeJcTTnncE6OzilcSu1qUEejHNdPz+fG0CqpOlCbLGKnp6SSgNr+up+nxktRfzrMwaXa3x3A/POaU7RTLgb8UqEYcKd3cHbkoUHc6a22106E3rzxl2ge3sl6Jmtue+zbnnoo9IoDzfp41BHL1DubOWEjYSe15BU0mgoImms007SO8CTisZ3wtf1gPQj6zllhfDqdmUc2YenKMkQyb2WW7HqQvneOqqjDYbOfffRR4cz+ekg/Rs+JSmNg6r6nvGC9s8cHxLop7lP9Wo5XHvH1+kZKuRe+CsMSxLNqTqZIqTaidMYrGInMGZpJWeDlpKQElN7MD0InrvYzFZkt+dp46TPTuwFUFDrr/SV5eho9noKmQVJ3n0g9WpKGyyKI80yBPX1mSvcWbTypXhCGAo0KRpsZmDkhCGBo8nR5BAUpkiiQ05MogBMiR12ZOXEL4hl/i/hiZHjDhFW1ZD+0B66fjM+sW7BJfTGh+yLjixqYmxIjnGbxJijPIYDr4OhXW8fj8R/eAVdIZXaA12/P5851MaNLQHX/AKTvh6Ak3NrKT4bW+O/juOkhrHpOcK+pAvrl/wDIH46AzbGP4lEwjtSAKqgEkhEB0It3RYDr106xIDGvaM3xNTwIXe/uqBv8IrInTwqoI5OR3NkyvI6hkc3eWFZCyzESTZZsIYEEJSM6QWl+tJDEjuKPS7dLdIEUnaagofMeBkpg1Y+7GC9V677Uwzn4KbymVqhZi53Ylj5k3P1lx4T3MDin5kLSH/MgH5GVEprb4Rr4IXbIW6znUmwBJOwGplu4J2CxFfvv+pQ83HebyTl8ZZaXB8Pgr6LmG7ubk+XQSjNl+NXVluPHufZ5Tj8FVp2zoyZtswteBS79tO0tOugooM1mDZjytyEpBlmGTnG5KmRkioukzTGXz/D5SwcA6gXlAMvf+GVT9Yy9QZn1zlHA5LwNg4mizYri1SmbHUQGr2nPSMeNYfeVPE0JzNPqHOPJ2np4ONpB57SeEyIvZTJq3Ir+BCym8Kp1ItRoVSadNo4gyptDaK3ilHtGGGr2iskZ06ekxjaRDFaSJ68ggIapJsBXs6Ho6f8AkIrarMo4lQwN+Y+sqzK4NfQ8U7R6vjDEWMaO8UdAeoERYszyGFKztadcCqu0Aq+f5+Pl9IdW/nAKqzqYzTJcAdYafn0tOuHoTUQWvd0HLnmte201XHO8I4CgOIpruc6emvPztNcejJk4IOPN/qa377/MkwBKTMbKpJ6AE/SF8XX9fVIuRnaxO513lv7A5Up1HdDldsuYAE3ABy28iZ0oNUkcicXbZX+D9k8RiLnKaajTMysdbXsAIQvYyocxSorKtsx9yxvYrY63vPR8Rj1T3UcAXzBKb3Nx3SABbeVrG8ScMVw9mJQF1zjOxP2mRrMNto0mvYisR/8ASTL7zr6wb/KE7xziwNrXmsTiMQXs4dWbTKQQbb6CCOignUkeN9ZTLIk/JdHFJ+iPH4VN1bKOgN9YrFrkZjptHDCnYC2pgPEQVpl6SjMPC+3QSI5U3Qzwvss/BeAV6+DSmBkWpVNR3fTuKoVbLubnX4S28K7PYbCjMFDON6j2J+HJfhKV2H7TPTVziC1mHuXOjDmA3ug9BppCcTxWliiz1K1VUViq00KqLLpdiQSxOvh4S2WRLsRY2PuLducPTIVSXJv7vIDn485TeMnD40mscS6BjlCstgLDbpzHrCGocOD5ijkgW1qW+QhXDcBgyV9nhS12uCzswzCx+0cp8pW5p+RtriVHiPZFkpLVSstQEkWAOgHMsNOnrEWI4ZWRc703CHQPlOUnznsxSmmZP0dVDtnZcjFC19WAtYC5O2k5r8WYFaYo57L3VVM4yHTQAHS+nwlkcrXD5EcE+jw02lt/w5cjEgddITxHjTrVcZGWzHuhMuXXQWsLaSbgXHnaugYNa43lGqySnilHb49lkcKj+Vl54tR1MqmNoay88Tp3lXx1Ked009vB2tPLdBFc9nMh/spudL5C7aUyngXP2T6Qylw5+h9DLbQwlXkqAeJEK76e86A+JE3vUyZw1p4lRThr8w3oYdhuG694PbwB/lHx4s6fapnppebftA/Jk1/Z2h80mT8UULP8vT7r+hg7YS32H+IMfVeIvYXxCa8lAMCPG0B713+NhF3y8MPjj6FpwTn7Bt5iQpw2mPezDyjZ+MKx7tMAeZnVFTUGbKoXwBlc8kq5LFBeC94jVF8VER42PD/tp+6Ig4hPPY3c3/Zq0wnxTjXWKquK1hGOfeJqtXXlOxhhZonKkS1sQPz9ITwDFFcRSa1wGFx1AtoIpqeYh2AUXQ3toxuN/eaa2komOfJ1i6zLVdWAuruDa1rhiDbwli7K4mqQ6ozIDZjl5styPLaV16eZm0AFzz2F+vOWjsS5o1GsRZsosdrk5QSP+X1lkGuPBkmmkx1ResjJeo/s17zm1zlJY5gjC4sOg+zpGNWvUylUXO7HQKoVQpvqWe46EXubW22jB3ZmK+zUpsGFmspW2q6G1ywO+hEHr11pqTY2UMgUK6mxF7i7aW1185pppcMy3b6EmD437Fj7TDgAn3kQJYWANwBZvlK3jxS9ocj3Q3ygg3XfRs626C1m8+cnxOPw6ISldkudEPeAJsblabFiSFsSRzG3NJW7UPfR6GmzZHBGnK6/hKnFtUXRpO0SVHQnvliBzGUE2AA5aWAtBcSyAfq0dtedTKNtTYIbyJ+JFtRiqS76AOLX/wCMGrYjQXxobUABQxt4m9rCSosmydc9nVgLEgLszW65iBlnWAwj3tYG/wB08/EBdRAqXEXRzkxWu2fVF9SbkfCOKfaLEAm/ElW4AvYtfQA6Zdt/HQSXFhYZQ4Q97mqFsLmyVvgllQA7jbTvbmHYbDYimrOhysHRD/p2ZlLbWzDT3R6xUe1QXIDjXfIzksKYGYG1gAF7vu66nfwj9e0+FdMxqszPURsoSoSGTa97XuFF7Dy2EFEVt+i0OcLkZa1Rny5A+d3IzWGgS9veGwHhGOBxiK60FUD7oXQBcrNYgbEAKPjKliMGlVwz+1TO2cO4CKGsWAKsQ2ilrLbofN1weoq4inTUuS6VH72W2RWsui7E5xvby5R4t7iqSVHn/aHE3xFYn/7HHo5H4QLC4gB1OmhEE4nULVah+87n1YmCJmDKRsDM+SN3z7NSf4nsddsyKeoH0iHGJG2EqZqCH9kRZjDPLY7U2vs6Ok/UTskydmZN1s30VSy2sXJPW5t8JlNdCR6/0g5dfIG9uennI/LQ+E7aicFyHOFtcZsg2Hea30G0ZPgAft0R4owPlzlX9tU5E/G/8rTMrnXKbdbECK8bvslS+i00uFUypJqMx3GW1h1B8YJj6eGp2GcknyNjfXYxKKLWtcD946D4GdgsPtKOlgtvgLSNntjbvomfHIuqC3iZxT4lUtYOQvIXsLwd7HclvDTSc06oU3yKf3tR8Y2yNdCtv2ey4Yh6FJgd0U/KJuI0zvKxwntbZAjOFCnRLd3LpohOx37tx8dRLVjagyhhnZWXNlAV3N9RlCGzfAzjy0GSE3KPVl+HJs7KpjKROgETVMKxOglxoPSqXGV0O/fpOgGtrd7nrt5yGq1IKTlJN9vY3bnsCRfY7TbCOWHgslnhIplTDNcCx9I34fgh+ruDez57jLbvnLv1FobWp5hdc6D7xRVsDa5Oult7b6aDlENbirIXUVFYNYBly3I+0WIJIFwLDTyta+lRlKNFDnEIbGAO1gDqdh48o97K4gvVtYLZSw8Sney/KU0W5NG/A6+Riwaxym1vLwlrioozyk2ey4BW7htvkOh202+cZY8gIxNtr3I0HiZWuz/E6rZQyhgANQCp0A33B+Ue43FqUdWBFxaxF9+Wk2Y3GUDHJNSoqHFVSqMqforakt7UImht3gdDuDr4So8YwWHplAaOFqZ7/wC3UZtRb7rabwrtPgM/eDoSC1lLKhVbDLYOQSL30lKq8Pr2P6pm2AKrm18CtxfT6yqovplkXJeBhVwuFOvsFt+zXNz4AG5MjHCcM1z7Mi3/AOhRf4MkVLgqwOtGoLDW6Ov1ENw1F7HuN/2mTta8k7voI/ybCgXyO3P/AHwP/XOkweEB/wDiux6Gs/8ACo+smFF9O42w5GTUA3PTzEj8vYbvoEq1qKe7gqYOoGY1Httvd/KWGiMYrU0GIw1BH0BTJlpgKWu4tYA7a33iKpQdn0APmVUfEkgQ3H4e6Fc6XKG3fRr2AFu6T1EGgcn6G2FwmHzlanFfb1O8ypSDMha2uYi630+ktnZg4fMHVmNVKTs19FVWK3Hj7g1nlXCuDPRqo71KQzA6CorEXGpZUuwt5S7cAwCNUq5sSPYCnkcgmgHzfZzN3stxuCt9NLE3j/dV0RX48lCOKJF+uvXecjEa7+n4wJ7KcpvcaHS2o03GkkU32N/QxXCuS5Ss9c4DWzYZD8ILjmnHZKpfDAdDNY9p5aUazyX2dXRrgWs01I2MyaqOlRWUqoN0PPmB8yDNM6fZQDzYt+AEGU33Yn5SREH9yTO5SPO2ECs2wK/L8/2nNeo50JNvDb4zhE520khHhrFbSYK6IAN9ZsLfn6Tux8JumhGunyg5AkRZPz5QnDYEuQCdOflJKYUnUbyz8Cw4uPlM+fUbI2XQx2yCpwWiidxNSNSdvW0qmMolGIUlOd1YgfLnPVOKrdNdNPh8p5zxSkAT9Zn0eolkbbLtqcehT/mNYafpFXw77m3hvOBxKtsatS2985B6biZVW/T1EHYDnOrGSM8okLBnPeZmPLM2a3xY6QvBUUAYOt/ukNax66XDes0gXp+ELw9TwA9YTm6oVRRzTpC9rGOuF4RQQ17eG5877QJHty9PzvDMPU8PWUSk2hdqPROzlULmbUEkalryw8RxJZHAQ+6NSLb31Fx9ZWOC8QRES7ogNr52tfck7gf3h/EO0+ECuBXVyVtakDU186YPzmnDJKFGXJFufB51xWs1212J/OkRPXXYj5RxjWzk5Uc+ahfkTf5Ra2FY7qB5629BM6o0IhvT5ZvW0xaqj7bqeucwmnwwsL3X5zv/ACQ7A3A5jSG+K8k7SAVF3NZ9b/abXw94yH2NK2i3PSx38zpGQ4J42P58ZInBlB72o8/wt4CHyx9k7KK5Up32W3xF/lMw+CZj/cyzHhqDkBMpYVbjTTy/nD5/RHxoTphMrjU/T6a9Z6n2Fp0qaFgi523YAE223P8APnEK4KkQDmv5C52/vLlwOpTSnaxA2N1tcnyGvnHxTcnyV5EqPKu1uHAxNRvvMW8NTeISg6/n4y69tsKpqsybNrzOvPfUf0lNfDHmZO7nsZR4PQuw7Xw7DoYRjoL2DS1F/OF4/nPO5v5Ev7OrovQnaZMJmS86RUsjDlJEWFo6NysfMCSLQU6WueonXcvZ5pRBwl9Np0tE9ZM2F6Gcth3GxvF3J+R0iJqbbkjeYae2v4TtFN++DOnxKKNbfExW30iVR1Toa7/ylm4UGW2XWU9OIIPtFvAAyycE4vpZaFRj8FX4kzLqcU3HovxyRYOIM7Jrp9ZR+Kprrc+EtvEBiHp3DU6Xhq59dB8pTcbw9ySXrs37oAEr0cFHuS/osk/xqhWUvoLQd2UfaHqITVwKrqcx8zI/ZqNlHpedWLiZnZAtcX018oZQZjshPS5AkDvfkAJPh6h6m0JdcIT/AKTpTb9ked2t8NIdgcKWYKXY9SLKPUQVK4H9Y04ViQrBiLgbecplKVEcItfA+BYYMt6SudiWu5vY66y5nDqqsFQKLaZQqgHzt+Er3ZrHZ3JsQLbW/lH3EKKlH32N7E3mjHG0zNOXNHmGPrEO4uNzzzc/KCFC35tNcRBV20trz3gwqG2pmVxafBqT4CshXUNf0JnDVXOtr/I/WCGueRmLXMZRfki0MFrsedvA6/OabGEaMLQRa3jJlrXEXavRNndStcaE+M3Rc330+AgzDoZtbwpByNUrk2tY+nyli4dWqhBkVQBvfUWvrp1lUwtcAi8s1DiACDKNT12+MmPDEkrEPafPmzM1762tYyrVD4SzcexTv7xGh0EqldfGWR5DwX/sIf1bwviI3i//AA+e6OOkZcRXecHPxqWdHRvkr9Q6mZNPvNTSdOyuiEYObmTqS6POIYLsZG0yZKCxEZ5wLGoLjQekyZHx9g+grBUl00HoI+wk3MmbVGjCN8V7kqfEN5kyZNL2WzE1eDHeZMnYj0ZWaeZRm5kd9FTJOcb4DebmRZCF17He/wDCXXFe6/kZkyacP6sy5f2PIONf7recVtNzJml+zNUekRmaSZMgBKJtJkyKyUbO000yZEGO6PKGs56n1mpkYVkPEecSvMmR4EMun+He9Ty/GPOJ85kycLVfymbtH2VupuZkyZL0dY//2Q==)

---
# **Prediction of Smoking with Body Signals**
---
"""

from google.colab import drive
drive.mount('/content/drive')

#@title Library Imports
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import plotly.express as px
import plotly.graph_objs as go
import warnings

#@title Download Dataset
# download dataset
!gdown 1rmRApCITxBsJu0X8RuvJ5-Ht560k1WKH
# https://drive.google.com/file/d/1rmRApCITxBsJu0X8RuvJ5-Ht560k1WKH/view?usp=drive_link

"""<html>
<style>
   
table, th, td {
  border:1px solid black;
}    
</style>
<body>

<table style="width:95%;font-size:16px">
  <tr>
    <th style="width:2%">S/N</th>
    <th style="width:10%">Attributes</th>
    <th style="width:40%">Description</th>
    <th>Codes</th>
  </tr>
  <tr>
    <td>1</td>
    <td>sex</td>
    <td>gender</td>
    <td>1= Male, 0= Female</td>
  </tr>
  <tr>
    <td>2</td>
    <td>age</td>
    <td>ages were rounded up to 5 years</td>
    <td>-</td>
  </tr>
  <tr>
    <td>3</td>
    <td>height</td>
    <td>height in cm</td>
    <td>-</td>
  </tr>
  <tr>
    <td>4</td>
    <td>weight</td>
    <td>weight in kg</td>
    <td>-</td>
  </tr>
  <tr>
    <td>5</td>
    <td>waistline</td>
    <td>waistline</td>
    <td>-</td>
  </tr>
  <tr>
    <td>6</td>
    <td>sight_left</td>
    <td>eye sight (left)</td>
    <td>-</td>
  </tr>
  <tr>
    <td>7</td>
    <td>sight_right</td>
    <td>eye sight (right)</td>
    <td>-</td>
  </tr>
  <tr>
    <td>8</td>
    <td>hear_left</td>
    <td>hearing left</td>
    <td>1= normal, 2= abnormal</td>
  </tr>
  <tr>
    <td>9</td>
    <td>hear_right</td>
    <td>hearing right</td>
    <td>1= normal, 2= abnormal</td>
  </tr>
  <tr>
    <td>10</td>
    <td>SBP</td>
    <td>Systolic blood pressure in mmHg</td>
    <td>-</td>
  </tr>
  <tr>
    <td>11</td>
    <td>DBP</td>
    <td>Diastolic blood pressure in mmHg</td>
    <td>-</td>
  </tr>
  <tr>
    <td>12</td>
    <td>BLDS</td>
    <td>Fasting blood glucose in mg/dL</td>
    <td>-</td>
  </tr>
  <tr>
    <td>13</td>
    <td>tot_chole</td>
    <td>total cholesterol in mg/dL</td>
    <td>-</td>
  </tr>
  <tr>
    <td>14</td>
    <td>HDL_chole</td>
    <td>High Density Lipoprotein Chokesterol in mg/dL</td>
    <td>-</td>
  </tr>
  <tr>
    <td>15</td>
    <td>LDL_chole</td>
    <td>Low Density Lipoprotein Chokesterol in mg/dL</td>
    <td>-</td>
  </tr>
  <tr>
    <td>16</td>
    <td>triglyceride</td>
    <td>Triglycerides are a type of fat, called lipid , that circulate in your blood measured in mg/dL</td>
    <td>-</td>
  </tr>
  <tr>
    <td>17</td>
    <td>hemoglobin</td>
    <td>Hemoglobin is a protein in red blood cells that carries oxygen measured in mg/dL</td>
    <td>-</td>
  </tr>
  <tr>
    <td>18</td>
    <td>urine_protein</td>
    <td>Level of proteins in the urine</td>
    <td>1 = (-), 2 = (+/-), 3 = (+1), 4 = (+2), 5 = (+3), 6 = (+4)</td>
  </tr>
  <tr>
    <td>19</td>
    <td>serum_creatinine</td>
    <td>Serum creatiine is a kidney funtion test measured with urine (mg/dL)</td>
    <td>-</td>
  </tr>
  <tr>
    <td>20</td>
    <td>SGOT_AST</td>
    <td>SGOT (serum glutamic-oxaloacetic transaminase) is also known as AST (Aspartate aminotransferase) which is one of the two liver enzymes and` a protein made by liver cells measured in IU/L</td>
    <td>-</td>
  </tr>
  <tr>
    <td>21</td>
    <td>SGOT_ALT</td>
    <td>Alanine transaminase measured in IU/L</td>
    <td>-</td>
  </tr>
  <tr>
    <td>22</td>
    <td>gamma_GTP</td>
    <td>gamma glutamine transpeptidase measured in IU/L</td>
    <td>-</td>
  </tr>
  <tr>
    <td>23</td>
    <td>SMK_stat_type_cd</td>
    <td>Smoking status</td>
    <td>1 = never, 2 = used to smoke but quit, 3 = still smoke</td>
  </tr>
  <tr>
    <td>24</td>
    <td>DRK_YN</td>
    <td>Drinker or Not a Drinker</td>
    <td>0= N (No, not a drinker), 1= Y (Yes, a drinker)</td>
   </tr>
</table>

</body>
</html>

### Data Observations
"""

from IPython.display import display, HTML
def create_scrollable_table(df, table_id, title):
    html = f'<h3>{title}</h3>'
    html += f'<div id="{table_id}" style="height:200px; overflow:auto;">'
    html += df.to_html()
    html += '</div>'
    return html

smodrink_df= pd.read_csv('smoking_driking_dataset_Ver01.csv', encoding="ISO-8859-1")

raw_data = create_scrollable_table(smodrink_df.head(20),'raw_dataset', 'Smoking and Drinking')
display(HTML(raw_data))

data_description = create_scrollable_table(smodrink_df.describe(), 'numerical_features', 'Description of the dataset')
display(HTML(data_description))

# Know the number of rows and columns
shape = smodrink_df.shape
display(f"(Number of rows, Number of columns) = ", shape)

print("There are three types of data that exist in this dataset - object, integer and float")
types = smodrink_df.dtypes
display(types)

"""## Data Cleaning"""

# Convert height in cm to m
new_height = smodrink_df['height']/100
new_height

# Calculate new column - bmi
bmi = (smodrink_df["weight"]/new_height).round(1)
bmi

# Add bmi column to the data frame
smodrink_df.loc[:, "bmi"] = bmi
smodrink_df

smodrink_dfs = smodrink_df.drop(columns=['height', 'weight'], axis=1)
smodrink_dfs

#Convert the object data type to integers for ease of analysis
print(smodrink_dfs['sex'])

print(smodrink_dfs['DRK_YN'])

print("I have converted all the attributes of the dataset to a more ML-readable form")
smodrink_dfs["sex"]= smodrink_dfs["sex"].replace({"Female": 0, "Male": 1})
smodrink_dfs["DRK_YN"]= smodrink_dfs["DRK_YN"].replace({"N": 0, "Y": 1})

print(smodrink_dfs['sex'])
print(smodrink_dfs['DRK_YN'])

#Clean missing values
print("These are the missing values for each attribute.")
display(smodrink_dfs.isna().sum())

"""

*   There are no missing values in the dataset


"""

# Check for duplicate values
print("This is the total number of duplicated row in the dataset")
display(sum(smodrink_dfs.duplicated()))

"""* There are 26 duplicated rows"""

#Identify the row that is duplicated
print("See below the duplicated rows")
smodrink_dfs[smodrink_dfs.duplicated()]

smodrink_dfs1 = smodrink_dfs.drop_duplicates()

#Check if there are still duplicates
print("Be sure there are no duplicated rows")
smodrink_dfs1.shape

"""## MODELLING"""

#import relevant libraries
import matplotlib.pyplot as plt
import numpy
from sklearn import metrics
from sklearn.linear_model import LogisticRegression
from sklearn.svm import LinearSVC
from sklearn.svm import SVC
from sklearn.ensemble import RandomForestClassifier
from sklearn.ensemble import RandomForestRegressor
from sklearn.preprocessing import RobustScaler
from sklearn.model_selection import train_test_split,GridSearchCV
from sklearn.metrics import mean_squared_error, r2_score, accuracy_score, roc_auc_score, mean_absolute_error, classification_report
from sklearn.preprocessing import OneHotEncoder
from sklearn.metrics import classification_report
from sklearn.metrics import confusion_matrix
from sklearn.pipeline import make_pipeline
from sklearn.preprocessing import StandardScaler
from sklearn.model_selection import train_test_split
#import stacking classifier
from sklearn.ensemble import StackingClassifier
import warnings
# Filter out FutureWarnings from Seaborn
warnings.simplefilter(action='ignore', category=FutureWarning)

"""## SVM for Smoking Status"""

df_encoded = pd.get_dummies(smodrink_dfs1)

print("Original DataFrame:")
print(smodrink_dfs1)
print("\nDataFrame after one-hot encoding:")
print(df_encoded)

df_encoded.columns

X = df_encoded.drop(['SMK_stat_type_cd','DRK_YN'], axis=1)
y = df_encoded["SMK_stat_type_cd"]

"""##SVM / SVC"""

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
print(X_train)
print(y_train)

pipe = make_pipeline(StandardScaler())
pipe.fit(X_train, y_train)

pipe2 = make_pipeline(StandardScaler(), LinearSVC())
pipe2.fit(X_train, y_train)  # apply scaling on training data

pipe2.score(X_test, y_test)
y_pred_svm = pipe2.predict(X_test)

accuracy_svm = accuracy_score(y_test,y_pred_svm)
print('Accuracy', accuracy_svm)
print('Classification report', classification_report(y_test,y_pred_svm))

confusion_matrix = metrics.confusion_matrix(y_test, y_pred_svm)
cm_display = metrics.ConfusionMatrixDisplay(confusion_matrix = confusion_matrix, display_labels = [1,2,3])
cm_display.plot()
plt.show()